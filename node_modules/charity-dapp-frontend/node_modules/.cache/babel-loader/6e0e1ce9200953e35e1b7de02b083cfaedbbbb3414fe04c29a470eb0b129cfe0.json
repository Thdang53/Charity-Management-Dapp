{"ast":null,"code":"import _objectSpread from\"C:/Users/DMC/OneDrive/Documents/SUIMOVE/charity-dapp/charity-dapp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{useCurrentAccount,useSignAndExecuteTransaction}from'@mysten/dapp-kit';import{buildCreateCampaignTx}from'../utils/campaignManager';import{getExplorerUrl}from'../config/constants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function CreateCampaignForm(_ref){let{onSuccess,onCancel}=_ref;const currentAccount=useCurrentAccount();const{mutate:signAndExecute,isPending}=useSignAndExecuteTransaction();const[formData,setFormData]=useState({title:'',description:'',goal:'',durationDays:'30',beneficiary:''});const[errors,setErrors]=useState({});const[txDigest,setTxDigest]=useState('');const[createdCampaign,setCreatedCampaign]=useState(null);// Validation\nconst validate=()=>{const newErrors={};if(!formData.title.trim()){newErrors.title='Title is required';}else if(formData.title.length<5){newErrors.title='Title must be at least 5 characters';}if(!formData.description.trim()){newErrors.description='Description is required';}else if(formData.description.length<10){newErrors.description='Description must be at least 10 characters';}const goal=parseFloat(formData.goal);if(!formData.goal||isNaN(goal)||goal<=0){newErrors.goal='Goal must be greater than 0';}const duration=parseInt(formData.durationDays);if(!formData.durationDays||isNaN(duration)||duration<1){newErrors.durationDays='Duration must be at least 1 day';}if(!formData.beneficiary.trim()){newErrors.beneficiary='Beneficiary address is required';}else if(!formData.beneficiary.startsWith('0x')||formData.beneficiary.length!==66){newErrors.beneficiary='Invalid Sui address format';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!currentAccount){alert('Please connect your wallet first');return;}if(!validate()){return;}try{const tx=buildCreateCampaignTx({title:formData.title,description:formData.description,goal:parseFloat(formData.goal),durationDays:parseInt(formData.durationDays),beneficiary:formData.beneficiary});signAndExecute({transaction:tx},{onSuccess:result=>{console.log('Campaign created:',result);setTxDigest(result.digest);// ðŸŽ¯ Táº O CAMPAIGN OBJECT NGAY Láº¬P Tá»¨C (Optimistic Update)\nconst newCampaign={id:result.digest,// Táº¡m dÃ¹ng tx digest lÃ m ID\ntitle:formData.title,description:formData.description,creator:currentAccount.address,goal:parseFloat(formData.goal),raised:0,deadline:Date.now()+parseInt(formData.durationDays)*24*60*60*1000,beneficiary:formData.beneficiary,createdAt:Date.now()};setCreatedCampaign(newCampaign);// â±ï¸ Äá»£i 1.5 giÃ¢y Ä‘á»ƒ user tháº¥y success message, rá»“i callback\nsetTimeout(()=>{onSuccess(newCampaign);// Tráº£ campaign vá» parent\n},1500);},onError:error=>{console.error('Transaction failed:',error);alert(\"Failed to create campaign: \".concat(error.message));}});}catch(error){console.error('Error:',error);alert(\"Error: \".concat(error.message));}};// Success state\nif(txDigest&&createdCampaign){return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px',backgroundColor:'#e8f5e9',borderRadius:'12px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'64px',marginBottom:'16px'},children:\"\\u2705\"}),/*#__PURE__*/_jsx(\"h2\",{style:{color:'#2e7d32',marginBottom:'12px'},children:\"Campaign Created!\"}),/*#__PURE__*/_jsxs(\"p\",{style:{color:'#616161',marginBottom:'8px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:createdCampaign.title}),\" has been successfully created\"]}),/*#__PURE__*/_jsxs(\"p\",{style:{color:'#757575',fontSize:'14px',marginBottom:'20px'},children:[\"Goal: \",createdCampaign.goal,\" SUI | Duration: \",formData.durationDays,\" days\"]}),/*#__PURE__*/_jsx(\"a\",{href:getExplorerUrl('tx',txDigest),target:\"_blank\",rel:\"noopener noreferrer\",style:{display:'inline-block',padding:'12px 24px',backgroundColor:'#2196f3',color:'#fff',textDecoration:'none',borderRadius:'8px',fontWeight:'600'},children:\"View Transaction \\u2192\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'12px',fontSize:'13px',color:'#616161'},children:\"Redirecting to campaign list...\"})]});}return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:{maxWidth:'600px',margin:'0 auto',padding:'24px',backgroundColor:'#fff',borderRadius:'12px',boxShadow:'0 2px 16px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:0,marginBottom:'24px',color:'#212121'},children:\"Create New Campaign\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontWeight:'600',color:'#424242'},children:\"Campaign Title *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.title,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{title:e.target.value})),placeholder:\"e.g., Help Build School in Rural Vietnam\",style:{width:'100%',padding:'12px',border:errors.title?'2px solid #f44336':'1px solid #e0e0e0',borderRadius:'8px',fontSize:'15px',outline:'none',transition:'border-color 0.2s'},onFocus:e=>{if(!errors.title)e.currentTarget.style.borderColor='#2196f3';},onBlur:e=>{if(!errors.title)e.currentTarget.style.borderColor='#e0e0e0';}}),errors.title&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#f44336',fontSize:'13px',marginTop:'4px'},children:errors.title})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontWeight:'600',color:'#424242'},children:\"Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value})),placeholder:\"Describe your campaign goals and how funds will be used...\",rows:4,style:{width:'100%',padding:'12px',border:errors.description?'2px solid #f44336':'1px solid #e0e0e0',borderRadius:'8px',fontSize:'15px',outline:'none',resize:'vertical',fontFamily:'inherit'},onFocus:e=>{if(!errors.description)e.currentTarget.style.borderColor='#2196f3';},onBlur:e=>{if(!errors.description)e.currentTarget.style.borderColor='#e0e0e0';}}),errors.description&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#f44336',fontSize:'13px',marginTop:'4px'},children:errors.description})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'16px',marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontWeight:'600',color:'#424242'},children:\"Goal Amount (SUI) *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:formData.goal,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{goal:e.target.value})),placeholder:\"e.g., 100\",style:{width:'100%',padding:'12px',border:errors.goal?'2px solid #f44336':'1px solid #e0e0e0',borderRadius:'8px',fontSize:'15px',outline:'none'},onFocus:e=>{if(!errors.goal)e.currentTarget.style.borderColor='#2196f3';},onBlur:e=>{if(!errors.goal)e.currentTarget.style.borderColor='#e0e0e0';}}),errors.goal&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#f44336',fontSize:'13px',marginTop:'4px'},children:errors.goal})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontWeight:'600',color:'#424242'},children:\"Duration (days) *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formData.durationDays,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{durationDays:e.target.value})),placeholder:\"e.g., 30\",style:{width:'100%',padding:'12px',border:errors.durationDays?'2px solid #f44336':'1px solid #e0e0e0',borderRadius:'8px',fontSize:'15px',outline:'none'},onFocus:e=>{if(!errors.durationDays)e.currentTarget.style.borderColor='#2196f3';},onBlur:e=>{if(!errors.durationDays)e.currentTarget.style.borderColor='#e0e0e0';}}),errors.durationDays&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#f44336',fontSize:'13px',marginTop:'4px'},children:errors.durationDays})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'24px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'6px',fontWeight:'600',color:'#424242'},children:\"Beneficiary Address *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.beneficiary,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{beneficiary:e.target.value})),placeholder:\"0x...\",style:{width:'100%',padding:'12px',border:errors.beneficiary?'2px solid #f44336':'1px solid #e0e0e0',borderRadius:'8px',fontSize:'14px',fontFamily:'monospace',outline:'none'},onFocus:e=>{if(!errors.beneficiary)e.currentTarget.style.borderColor='#2196f3';},onBlur:e=>{if(!errors.beneficiary)e.currentTarget.style.borderColor='#e0e0e0';}}),errors.beneficiary&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#f44336',fontSize:'13px',marginTop:'4px'},children:errors.beneficiary}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'13px',color:'#757575',marginTop:'4px'},children:\"Address that will receive the funds\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onCancel,disabled:isPending,style:{flex:1,padding:'14px',border:'1px solid #e0e0e0',borderRadius:'8px',fontSize:'16px',fontWeight:'600',cursor:isPending?'not-allowed':'pointer',backgroundColor:'#fff',color:'#616161'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isPending,style:{flex:2,padding:'14px',border:'none',borderRadius:'8px',fontSize:'16px',fontWeight:'600',cursor:isPending?'not-allowed':'pointer',backgroundColor:isPending?'#90caf9':'#2196f3',color:'#fff',transition:'background-color 0.2s'},onMouseEnter:e=>{if(!isPending)e.currentTarget.style.backgroundColor='#1976d2';},onMouseLeave:e=>{if(!isPending)e.currentTarget.style.backgroundColor='#2196f3';},children:isPending?'ðŸ”„ Creating...':'âœ¨ Create Campaign'})]})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}